# Diffie-Hellman cryptography

## key agreement

Assume a group is generated by some $g$. This $g$ is public. Actor 1 (Alice) picks an $x$ at random and computes $X = g^x$ and sends it over to actor 2. Actor 2 (Bob) picks $y$ at random and computes $Y = g^y$ and $K = X^y$ and sends $Y$ to actor 1. Actor 1 computes $K = Y^x$. The key is therefore $K = g^{xy}$.

The security requirement is that given $(g, g^x, g^y)$ it is hard to compute $g^{xy}$. Assuming authentication the secret key can be shared over a public channel. This is a public-key cryptography.

Example Diffie-Hellman groups:

- $Z_p^*$ (compute $g^x \bmod p$) for large primes $p$
- elliptic curves

## negligible function

$f(\lambda) = negl(\lambda) \iff \forall_n f(\lambda) = O(\lambda^{-n})$ as $\lambda \to \infty$

## the discrete logarithm problem (DL problem)

If we consider the subgroup generated by $g$ of prime order $q$. $\langle g \rangle \subseteq Z_p^*$. $\langle g \rangle = \{1, g, \cdots, g^{q-1}\} \iff \{0, 1, \cdots, q-1\} = Z_q$.

Relative to **Setup** the DL problem is hard if for any PPT (probabilistic-polynomial time) algorithm $\mathcal A$ the probability of returning 1 is $negl(\lambda)$.

DL($\lambda$):

1. Setup($1^\lambda$) $\to$ (group, q, g)
2. pick $x \in Z_q$
3. $X \leftarrow g^x$
4. $x' \leftarrow \mathcal A$(group, q, g, X)
5. return $1_{X = g^{x'}}$

- Advantage of $\mathcal A$: Adv(security parameter) = $P$\[Game $\to 1$]
- Security: $\forall_{PPT, \mathcal A} Adv = negl$

### general number field sieve (GNFS)

Algorithm for a subgroup of $Z_p^*$ with $n$ and $p$ prime.

### baby-step giant-step

For $g$ and $X$ in a cyclic group $G$, $B$ is an upper bound for $|G|$

## man in the middle

A middle man could establish a key with Alice and Bob and pass around the messages.

## computational diffie-hellman (CDH)

CDH($\lambda$):

1. Setup($1^\lambda$) $\to$ (group, q, g)
2. pick $x, y \in Z_q$
3. $X \leftarrow g^x$, $Y \leftarrow g^y$
4. $K \leftarrow \mathcal A$(group, q, g, X, Y)
5. return $1_{K = g^{xy}}$

CDH is as hard as DL.

## decisional diffie-hellman (DDH)

The DDH problem relative to **Setup** is hard if for any PPT algorithm $\mathcal A$ we have $Adv_\mathcal A(\lambda) = P[DDH(\lambda, 1) \to 1] - P[DDH(\lambda, 0) \to 1] = negl(\lambda)$

DDH($\lambda, b$):

1. Setup($1^\lambda$) $\to$ (group, q, g)
2. pick $x, y, z \in Z_q$
3. if $b = 1$ then $z \leftarrow xy$
4. $X \leftarrow g^x$, $Y \leftarrow g^y$, $Z \leftarrow g^z$
5. $t \leftarrow \mathcal A$(group, q, g, X, Y, Z)
6. return $t$
