<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>integrity_and_authentication</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <style>
    html {
      font-size: 100%;
      overflow-y: scroll;
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
    }
    body {
      color: #444;
      font-family: Georgia, Palatino, "Palatino Linotype", Times,
        "Times New Roman", serif;
      font-size: 12px;
      line-height: 1.7;
      padding: 1em;
      margin: auto;
      max-width: 42em;
      background: #fefefe;
    }
    a {
      color: #0645ad;
      text-decoration: none;
    }
    a:visited {
      color: #0b0080;
    }
    a:hover {
      color: #06e;
    }
    a:active {
      color: #faa700;
    }
    a:focus {
      outline: thin dotted;
    }
    ::-moz-selection {
      background: rgba(255, 255, 0, 0.3);
      color: #000;
    }
    ::selection {
      background: rgba(255, 255, 0, 0.3);
      color: #000;
    }
    a::-moz-selection {
      background: rgba(255, 255, 0, 0.3);
      color: #0645ad;
    }
    a::selection {
      background: rgba(255, 255, 0, 0.3);
      color: #0645ad;
    }
    p {
      margin: 1em 0;
    }
    img {
      max-width: 100%;
    }
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      color: #111;
      line-height: 125%;
      margin-top: 2em;
      font-weight: 400;
    }
    h4,
    h5,
    h6 {
      font-weight: 700;
    }
    h1 {
      font-size: 2.5em;
    }
    h2 {
      font-size: 2em;
    }
    h3 {
      font-size: 1.5em;
    }
    h4 {
      font-size: 1.2em;
    }
    h5 {
      font-size: 1em;
    }
    h6 {
      font-size: 0.9em;
    }
    blockquote {
      color: #666;
      margin: 0;
      padding-left: 3em;
      border-left: 0.5em #eee solid;
    }
    hr {
      display: block;
      height: 2px;
      border: 0;
      border-top: 1px solid #aaa;
      border-bottom: 1px solid #eee;
      margin: 1em 0;
      padding: 0;
    }
    code,
    kbd,
    pre,
    samp {
      color: #000;
      font-family: monospace, monospace;
      font-size: 0.98em;
    }
    pre {
      white-space: pre;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    b,
    strong {
      font-weight: 700;
    }
    dfn {
      font-style: italic;
    }
    ins {
      background: #ff9;
      color: #000;
      text-decoration: none;
    }
    mark {
      background: #ff0;
      color: #000;
      font-style: italic;
      font-weight: 700;
    }
    sub,
    sup {
      font-size: 75%;
      line-height: 0;
      position: relative;
      vertical-align: baseline;
    }
    sup {
      top: -0.5em;
    }
    sub {
      bottom: -0.25em;
    }
    ol,
    ul {
      margin: 1em 0;
      padding: 0 0 0 2em;
    }
    li p:last-child {
      margin-bottom: 0;
    }
    ol ol,
    ul ul {
      margin: 0.3em 0;
    }
    dl {
      margin-bottom: 1em;
    }
    dt {
      font-weight: 700;
      margin-bottom: 0.8em;
    }
    dd {
      margin: 0 0 0.8em 2em;
    }
    dd:last-child {
      margin-bottom: 0;
    }
    img {
      border: 0;
      -ms-interpolation-mode: bicubic;
      vertical-align: middle;
    }
    figure {
      display: block;
      text-align: center;
      margin: 1em 0;
    }
    figure img {
      border: none;
      margin: 0 auto;
    }
    figcaption {
      font-size: 0.8em;
      font-style: italic;
      margin: 0 0 0.8em;
    }
    table {
      margin-bottom: 2em;
      border-bottom: 1px solid #ddd;
      border-right: 1px solid #ddd;
      border-spacing: 0;
      border-collapse: collapse;
    }
    table th {
      padding: 0.2em 1em;
      background-color: #eee;
      border-top: 1px solid #ddd;
      border-left: 1px solid #ddd;
    }
    table td {
      padding: 0.2em 1em;
      border-top: 1px solid #ddd;
      border-left: 1px solid #ddd;
      vertical-align: top;
    }
    .author {
      font-size: 1.2em;
      text-align: center;
    }
    @media only screen and (min-width: 480px) {
      body {
        font-size: 14px;
      }
    }
    @media only screen and (min-width: 768px) {
      body {
        font-size: 16px;
      }
    }
    @media print {
      * {
        background: 0 0 !important;
        color: #000 !important;
        filter: none !important;
        -ms-filter: none !important;
      }
      body {
        font-size: 12pt;
        max-width: 100%;
      }
      a,
      a:visited {
        text-decoration: underline;
      }
      hr {
        height: 1px;
        border: 0;
        border-bottom: 1px solid #000;
      }
      a[href]:after {
        content: " (" attr(href) ")";
      }
      abbr[title]:after {
        content: " (" attr(title) ")";
      }
      .ir a:after,
      a[href^="#"]:after,
      a[href^="javascript:"]:after {
        content: "";
      }
      blockquote,
      pre {
        border: 1px solid #999;
        padding-right: 1em;
        page-break-inside: avoid;
      }
      img,
      tr {
        page-break-inside: avoid;
      }
      img {
        max-width: 100% !important;
      }
      @page :left {
        margin: 15mm 20mm 15mm 10mm;
      }
      @page :right {
        margin: 15mm 10mm 15mm 20mm;
      }
      h2,
      h3,
      p {
        orphans: 3;
        widows: 3;
      }
      h2,
      h3 {
        page-break-after: avoid;
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/darkreader@4.7.15/darkreader.min.js"></script>
  <script>
    DarkReader.enable({
      brightness: 100,
      contrast: 90,
      sepia: 10
    });
  </script>
  <link
    rel="icon"
    type="image/png"
    href="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcTJg97A-Sa8mxjkRCmjR51WjHATLvq2aF89Z1CprR2WcQ60qYZC"
  />
  <meta name="theme-color" content="#252525" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 data-number="1" id="integrity-and-authentication"><span
class="header-section-number">1</span> integrity and authentication</h1>
<h2 data-number="1.1" id="commitment-scheme"><span
class="header-section-number">1.1</span> commitment scheme</h2>
<p>When we want to ensure two actors make a decision before seeing the
decision of the other actor. Done through commits, where one actor sends
a commitment which stores the encrypted decision to the other actor.
Then the second actor sends back their decision. Finally, the first
actor sends the key for decrypting the commitment to see the
decision.</p>
<p><strong>security:</strong></p>
<ol type="1">
<li>hiding: no information about the decision can be inferred from the
commitment</li>
<li>biding: cannot produce a commitment c such that Open(c, k) <span
class="math inline">\ne</span> Open(c, k’)</li>
</ol>
<h2 data-number="1.2" id="pseudorandom-number-generator-prng"><span
class="header-section-number">1.2</span> pseudorandom number generator
(PRNG)</h2>
<p><strong>security</strong>: indistinguishable from truly random.</p>
<h2 data-number="1.3" id="pseudorandom-function-prf"><span
class="header-section-number">1.3</span> pseudorandom function
(PRF)</h2>
<p><strong>security</strong>: indistinguishable from truly random
function (black-box).</p>
<p>PRF is <span class="math inline">(q, t, \varepsilon)</span>-secure if
for all bounded <span class="math inline">\mathcal A</span> <span
class="math inline">Adv(\mathcal A) = P[b&#39; = 1 | b = 1] - P[b&#39; =
1 | b = 0]</span> is negligible. Where <span
class="math inline">q</span> is the amount of queries done with
complexity <span class="math inline">t</span>.</p>
<h2 data-number="1.4" id="key-derivation-function-kdf"><span
class="header-section-number">1.4</span> key derivation function
(KDF)</h2>
<p><strong>security</strong>: one-way</p>
<h2 data-number="1.5" id="hash-functions"><span
class="header-section-number">1.5</span> hash functions</h2>
<p>There is no key that allows to reverse a hash.</p>
<ul>
<li>collision resistance</li>
<li>one-way</li>
<li>pseudo-randomness</li>
</ul>
<table>
<thead>
<tr class="header">
<th>algorithm</th>
<th>digest</th>
<th>comment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MD5</td>
<td>128</td>
<td>broken</td>
</tr>
<tr class="even">
<td>SHA-1</td>
<td>160</td>
<td>broken</td>
</tr>
<tr class="odd">
<td>SHA-2</td>
<td>224, 265, 384, 512</td>
<td></td>
</tr>
<tr class="even">
<td>SHA-3</td>
<td>224, 265, 384, 512</td>
<td></td>
</tr>
</tbody>
</table>
<h3 data-number="1.5.1" id="attacks"><span
class="header-section-number">1.5.1</span> attacks</h3>
<ol type="1">
<li>collision attack: find x and x’ such that <span
class="math inline">x \ne x&#39;</span> and <span
class="math inline">h(x) = h(x&#39;)</span></li>
<li>1st pre-image attack: given y find x such that <span
class="math inline">y = h(x)</span></li>
<li>2nd pre-image attack: given x find x’ such that <span
class="math inline">x \ne x&#39;</span> and <span
class="math inline">h(x) = h(x&#39;)</span></li>
</ol>
<h3 data-number="1.5.2"
id="encryption-to-hashing-merkle-damgard-scheme"><span
class="header-section-number">1.5.2</span> encryption to hashing
(merkle-damgard scheme)</h3>
<p>Treat the message as keys into some encryption function. Encrypt
blocks with some seed value. Xor results of individual blocks. Pad the
message if needed.</p>
<p>If the encryption function is collision resistant then the resulting
hash function is collision resistant.</p>
<h4 data-number="1.5.2.1" id="merkle-damgard-extension"><span
class="header-section-number">1.5.2.1</span> merkle-damgard
extension</h4>
<p>For padding messages. pad = <span class="math inline">|1|0\cdots 0
|\textit{length}|</span> where <em>length</em> is a 64-bit number.</p>
<h3 data-number="1.5.3" id="davis-meyer-scheme"><span
class="header-section-number">1.5.3</span> davis-meyer scheme</h3>
<figure>
<img src="assets/davis-meyer.png" alt="Davis-Meyer scheme" />
<figcaption aria-hidden="true">Davis-Meyer scheme</figcaption>
</figure>
<h2 data-number="1.6" id="mac-message-authentication-codes"><span
class="header-section-number">1.6</span> MAC (message authentication
codes)</h2>
<p>Authentication and verification of messages.</p>
<p><strong>security</strong>: unforgeability</p>
<h3 data-number="1.6.1" id="hmac"><span
class="header-section-number">1.6.1</span> HMAC</h3>
<p>Given a hash function <span class="math inline">H</span> create a
MAC. First key is padded (or truncated) with zeros to the fixed length.
Then:</p>
<p><span class="math display">
\text{HMAC}_K(X) = H((K \oplus \text{opad}) || H((K \oplus
\text{ipad})||X))
</span></p>
<p>Where opad is repeated <code>0x5c</code> and ipad is repeated
<code>0x36</code>.</p>
<p>If compression function is PRF then HMAC is PRF.</p>
<h3 data-number="1.6.2" id="cbcmac"><span
class="header-section-number">1.6.2</span> CBCMAC</h3>
<p>CBC mode of operation. MAC is the result of the last block of
encryption. We use and IV equal to 0.</p>
<p>It is not secure as an attacker can engineer same MAC by appending
something to the message. It is secure if the message length is
fixed.</p>
<h4 data-number="1.6.2.1" id="emac"><span
class="header-section-number">1.6.2.1</span> EMAC</h4>
<p>CBCMAC but we additionally encrypt the final output.</p>
<h4 data-number="1.6.2.2" id="cmac"><span
class="header-section-number">1.6.2.2</span> CMAC</h4>
<p>CBCMAC but last block is XORed with <span
class="math inline">k_{case}</span> before encryption. Output is
truncated.</p>
<h4 data-number="1.6.2.3" id="pmac"><span
class="header-section-number">1.6.2.3</span> PMAC</h4>
<p>It exists.</p>
<h3 data-number="1.6.3" id="universal-hash-function"><span
class="header-section-number">1.6.3</span> universal hash function</h3>
<p>Let <span class="math inline">(h_K)_{K \in_U \mathcal K}</span> be a
family of hash functions from <span class="math inline">D</span> to
<span class="math inline">\{0, 1\}^m</span> defined by a random key
<span class="math inline">K</span> which is chosen uniformly from a key
space <span class="math inline">\mathcal K</span>. This family is <span
class="math inline">\varepsilon</span>-XOR-universal if for any <span
class="math inline">a</span> and <span class="math inline">x \ne
y</span> in <span class="math inline">D</span>,</p>
<p><span class="math display">
P[h_K(x) \oplus h_K(y) = 1] \le \varepsilon
</span></p>
<h3 data-number="1.6.4" id="wc-mac"><span
class="header-section-number">1.6.4</span> WC-MAC</h3>
<p>MAC<span class="math inline">_{K, K_i}(i, x) = h_K(x) \oplus
K_i</span> for a <span
class="math inline">\varepsilon</span>-XOR-universal hash function and
unique <span class="math inline">K_i</span> (cannot be reused).</p>
<h3 data-number="1.6.5" id="authentication-modes"><span
class="header-section-number">1.6.5</span> authentication modes</h3>
<table>
<thead>
<tr class="header">
<th>mode</th>
<th>comment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CCM</td>
<td>CTR + CBCMAC</td>
</tr>
<tr class="even">
<td>GCM</td>
<td>CTR + WC-MAC</td>
</tr>
<tr class="odd">
<td>GCM-SIV</td>
<td>CTR + WC-MAC</td>
</tr>
<tr class="even">
<td>ChaCha20-Poly1305</td>
<td>stream cipher + WC-MAC</td>
</tr>
</tbody>
</table>
<h4 data-number="1.6.5.1" id="ccm"><span
class="header-section-number">1.6.5.1</span> CCM</h4>
<ol type="1">
<li>select nonce N</li>
<li>T = CBCMAC(message)</li>
<li>encrypt T||message in CTR using N</li>
</ol>
<h4 data-number="1.6.5.2" id="gcm"><span
class="header-section-number">1.6.5.2</span> GCM</h4>
<p>Takes plaintext plus extra data.</p>
<h3 data-number="1.6.6" id="one-wayness"><span
class="header-section-number">1.6.6</span> one-wayness</h3>
<p>Game:</p>
<ol type="1">
<li>pick x <span class="math inline">\in</span> D</li>
<li>y <span class="math inline">\leftarrow</span> h(x)</li>
<li><span class="math inline">\mathcal A(y) \to x&#39;</span></li>
<li>return 1<span class="math inline">_{h(x&#39;) = y}</span></li>
</ol>
<h3 data-number="1.6.7" id="mac-key-recovery"><span
class="header-section-number">1.6.7</span> MAC key-recovery</h3>
<p>Game:</p>
<ol type="1">
<li>K <span class="math inline">\stackrel{\$}{\leftarrow} \{0,
1\}^k</span></li>
<li><span class="math inline">\mathcal A^{\text{OMac}} \to
K&#39;</span></li>
<li>return 1<span class="math inline">_{K = K&#39;}</span></li>
</ol>
<p>Oracle OMac(X):</p>
<ol type="1">
<li>return MAC(K, X)</li>
</ol>
<h3 data-number="1.6.8" id="mac-forgery"><span
class="header-section-number">1.6.8</span> MAC forgery</h3>
<p>Game:</p>
<ol type="1">
<li>K <span class="math inline">\stackrel{\$}{\leftarrow} \{0,
1\}^k</span></li>
<li>Queried <span class="math inline">\leftarrow \emptyset</span></li>
<li><span class="math inline">\mathcal A^{\text{OMac}} \to (X,
t)</span></li>
<li>if <span class="math inline">X \in</span> Queried then return 0</li>
<li>return 1<span class="math inline">_{\text{MAC}(K, X) =
t}</span></li>
</ol>
<p>Oracle OMac(X):</p>
<ol type="1">
<li>Queried = Queried <span class="math inline">\cup \{X\}</span></li>
<li>return MAC(K, X)</li>
</ol>
<p>secure against forgeries <span class="math inline">\implies</span>
secure against key recovery</p>
<h3 data-number="1.6.9" id="mac-distinguisher"><span
class="header-section-number">1.6.9</span> MAC distinguisher</h3>
<p><span class="math display">
Adv = Pr[\Gamma_1 \text{ returns } 1] - Pr[\Gamma_0 \text{ returns } 1]
</span></p>
<p>Game <span class="math inline">\Gamma_b</span>:</p>
<ol type="1">
<li><span class="math inline">K \stackrel{\$}{\leftarrow} \{0,
1\}^k</span></li>
<li>pick <span class="math inline">F : D \to \{0, 1\}^\tau</span></li>
<li><span class="math inline">\mathcal A^{O} \to z</span></li>
<li>return <span class="math inline">z</span></li>
</ol>
<p>O(X):</p>
<ol type="1">
<li>if b = 0 then return <span class="math inline">F(X)</span></li>
<li>return MAC(K, X)</li>
</ol>
<p>secure against distinguisher <span
class="math inline">\implies</span> secure against forgeries</p>
<h2 data-number="1.7" id="birthday-paradox"><span
class="header-section-number">1.7</span> birthday paradox</h2>
<p>The probability of picking the same number twice from <span
class="math inline">\{1, \cdots, N\}</span> when picking n times with
uniform probability is <span class="math inline">p = 1 - \frac{N!}{N^n(N
- n)!}</span></p>
<p>For <span class="math inline">\theta = \frac{n}{\sqrt{N}}</span>,
<span class="math inline">p \stackrel{N \to \infty}{\longrightarrow} 1 -
e^{-\frac{\theta^2}{2}}</span></p>
<h3 data-number="1.7.1" id="collision-search"><span
class="header-section-number">1.7.1</span> collision search</h3>
<ol type="1">
<li>for <span class="math inline">\theta \sqrt{N}</span> times pick x,
compute y = h(x). If y is in the hash map, return x and x’. Otherwise
insert into hash map.</li>
</ol>
<h2 data-number="1.8" id="rho-effect"><span
class="header-section-number">1.8</span> rho effect</h2>
<p>If we start with x that is outside of a cycle and then continuously
hash x, h(x), h(h(x)), etc, we eventually reach enter a cycle. Let <span
class="math inline">h_t(x)</span> be the point where we enter the cycle.
If we continue hashing, eventually <span class="math inline">h^k(x) =
h_t(x)</span> where <span class="math inline">k \ne l</span> (because we
are in a cycle and we entered to it from a different side). This means
<span class="math inline">h^{k-1}(x)</span> and <span
class="math inline">h_{t-1}(x)</span> are two different values that hash
to the same thing: a collision.</p>
</body>
</html>
