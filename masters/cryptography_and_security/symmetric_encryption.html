<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>symmetric_encryption</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <style>
    html {
      font-size: 100%;
      overflow-y: scroll;
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
    }
    body {
      color: #444;
      font-family: Georgia, Palatino, "Palatino Linotype", Times,
        "Times New Roman", serif;
      font-size: 12px;
      line-height: 1.7;
      padding: 1em;
      margin: auto;
      max-width: 42em;
      background: #fefefe;
    }
    a {
      color: #0645ad;
      text-decoration: none;
    }
    a:visited {
      color: #0b0080;
    }
    a:hover {
      color: #06e;
    }
    a:active {
      color: #faa700;
    }
    a:focus {
      outline: thin dotted;
    }
    ::-moz-selection {
      background: rgba(255, 255, 0, 0.3);
      color: #000;
    }
    ::selection {
      background: rgba(255, 255, 0, 0.3);
      color: #000;
    }
    a::-moz-selection {
      background: rgba(255, 255, 0, 0.3);
      color: #0645ad;
    }
    a::selection {
      background: rgba(255, 255, 0, 0.3);
      color: #0645ad;
    }
    p {
      margin: 1em 0;
    }
    img {
      max-width: 100%;
    }
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      color: #111;
      line-height: 125%;
      margin-top: 2em;
      font-weight: 400;
    }
    h4,
    h5,
    h6 {
      font-weight: 700;
    }
    h1 {
      font-size: 2.5em;
    }
    h2 {
      font-size: 2em;
    }
    h3 {
      font-size: 1.5em;
    }
    h4 {
      font-size: 1.2em;
    }
    h5 {
      font-size: 1em;
    }
    h6 {
      font-size: 0.9em;
    }
    blockquote {
      color: #666;
      margin: 0;
      padding-left: 3em;
      border-left: 0.5em #eee solid;
    }
    hr {
      display: block;
      height: 2px;
      border: 0;
      border-top: 1px solid #aaa;
      border-bottom: 1px solid #eee;
      margin: 1em 0;
      padding: 0;
    }
    code,
    kbd,
    pre,
    samp {
      color: #000;
      font-family: monospace, monospace;
      font-size: 0.98em;
    }
    pre {
      white-space: pre;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    b,
    strong {
      font-weight: 700;
    }
    dfn {
      font-style: italic;
    }
    ins {
      background: #ff9;
      color: #000;
      text-decoration: none;
    }
    mark {
      background: #ff0;
      color: #000;
      font-style: italic;
      font-weight: 700;
    }
    sub,
    sup {
      font-size: 75%;
      line-height: 0;
      position: relative;
      vertical-align: baseline;
    }
    sup {
      top: -0.5em;
    }
    sub {
      bottom: -0.25em;
    }
    ol,
    ul {
      margin: 1em 0;
      padding: 0 0 0 2em;
    }
    li p:last-child {
      margin-bottom: 0;
    }
    ol ol,
    ul ul {
      margin: 0.3em 0;
    }
    dl {
      margin-bottom: 1em;
    }
    dt {
      font-weight: 700;
      margin-bottom: 0.8em;
    }
    dd {
      margin: 0 0 0.8em 2em;
    }
    dd:last-child {
      margin-bottom: 0;
    }
    img {
      border: 0;
      -ms-interpolation-mode: bicubic;
      vertical-align: middle;
    }
    figure {
      display: block;
      text-align: center;
      margin: 1em 0;
    }
    figure img {
      border: none;
      margin: 0 auto;
    }
    figcaption {
      font-size: 0.8em;
      font-style: italic;
      margin: 0 0 0.8em;
    }
    table {
      margin-bottom: 2em;
      border-bottom: 1px solid #ddd;
      border-right: 1px solid #ddd;
      border-spacing: 0;
      border-collapse: collapse;
    }
    table th {
      padding: 0.2em 1em;
      background-color: #eee;
      border-top: 1px solid #ddd;
      border-left: 1px solid #ddd;
    }
    table td {
      padding: 0.2em 1em;
      border-top: 1px solid #ddd;
      border-left: 1px solid #ddd;
      vertical-align: top;
    }
    .author {
      font-size: 1.2em;
      text-align: center;
    }
    @media only screen and (min-width: 480px) {
      body {
        font-size: 14px;
      }
    }
    @media only screen and (min-width: 768px) {
      body {
        font-size: 16px;
      }
    }
    @media print {
      * {
        background: 0 0 !important;
        color: #000 !important;
        filter: none !important;
        -ms-filter: none !important;
      }
      body {
        font-size: 12pt;
        max-width: 100%;
      }
      a,
      a:visited {
        text-decoration: underline;
      }
      hr {
        height: 1px;
        border: 0;
        border-bottom: 1px solid #000;
      }
      a[href]:after {
        content: " (" attr(href) ")";
      }
      abbr[title]:after {
        content: " (" attr(title) ")";
      }
      .ir a:after,
      a[href^="#"]:after,
      a[href^="javascript:"]:after {
        content: "";
      }
      blockquote,
      pre {
        border: 1px solid #999;
        padding-right: 1em;
        page-break-inside: avoid;
      }
      img,
      tr {
        page-break-inside: avoid;
      }
      img {
        max-width: 100% !important;
      }
      @page :left {
        margin: 15mm 20mm 15mm 10mm;
      }
      @page :right {
        margin: 15mm 10mm 15mm 20mm;
      }
      h2,
      h3,
      p {
        orphans: 3;
        widows: 3;
      }
      h2,
      h3 {
        page-break-after: avoid;
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/darkreader@4.7.15/darkreader.min.js"></script>
  <script>
    DarkReader.enable({
      brightness: 100,
      contrast: 90,
      sepia: 10
    });
  </script>
  <link
    rel="icon"
    type="image/png"
    href="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcTJg97A-Sa8mxjkRCmjR51WjHATLvq2aF89Z1CprR2WcQ60qYZC"
  />
  <meta name="theme-color" content="#252525" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 data-number="1" id="symmetric-encryption"><span
class="header-section-number">1</span> symmetric encryption</h1>
<h2 data-number="1.1" id="cryptographic-primitive"><span
class="header-section-number">1.1</span> cryptographic primitive</h2>
<ol type="1">
<li>components (alice, bob, key generator, encrypt, decrypt)</li>
<li>functionality (correctness)</li>
<li>security (confidentiality is preserved, perfect secrecy)</li>
</ol>
<h3 data-number="1.1.1" id="security-notions"><span
class="header-section-number">1.1.1</span> security notions</h3>
<p>Adversary objective: learn confidential information. Typically it is
key recovery.</p>
<ul>
<li><strong>ciphertext only attack</strong>: using ciphertexts in
transit only.</li>
<li><strong>known plaintext attack</strong>: same + known (or guess) the
corresponding plaintexts</li>
<li><strong>chosen plaintext attack</strong>: force the sender to
encrypt some messages selected by the adversary</li>
<li><strong>chosen ciphertext attack</strong>: force the receiver to
decrypt some messages selected by the adversary</li>
</ul>
<h2 data-number="1.2" id="block-ciphers"><span
class="header-section-number">1.2</span> block ciphers</h2>
<h3 data-number="1.2.1" id="data-encryption-standard-des"><span
class="header-section-number">1.2.1</span> data encryption standard
(DES)</h3>
<p>Encrypts blocks of 64 bits. Key of length 64 bits, but 8 bits are
parity bits. We use key schedule to get 16 rounds of 48 bit keys from
the main key. We split the plaintext block into two 32 bit parts. We
apply the Feistel scheme.</p>
<p>Susceptible to exhaustive search due to small key. There exist keys
which produce very weak ciphers.</p>
<h4 data-number="1.2.1.1" id="feistel-scheme"><span
class="header-section-number">1.2.1.1</span> Feistel scheme</h4>
<p><span class="math inline">\Psi(F^{K_1}, \cdots, F^{K_k}) =
\Psi^{-1}(F^{K_k}, \cdots, F^{K_1})</span></p>
<ul>
<li>uses a function over <span class="math inline">\{0,
1\}^{\frac{n}{2}}</span> to be a function transforming into permutations
over <span class="math inline">\{0, 1\}^n</span></li>
<li>inverse permutations have same structure</li>
<li>alternate round functions and halve swaps</li>
<li>final halve swap omitted</li>
</ul>
<figure>
<img src="./assets/feistel_scheme.png" alt="Feistel scheme" />
<figcaption aria-hidden="true">Feistel scheme</figcaption>
</figure>
<h3 data-number="1.2.2" id="advanced-encryption-standard-aes"><span
class="header-section-number">1.2.2</span> advanced encryption standard
(AES)</h3>
<p>Encrypts blocks of 128 bits. Uses key of length 128, 192, or 256.</p>
<ul>
<li>transform the block to a <span class="math inline">4 \times 4</span>
matrix of bytes</li>
<li>number of rounds 10, 12, or 14 depending on key length</li>
<li>non-terminal round:
<ul>
<li><strong>SubBytes</strong>: map each byte in matrix through a
table</li>
<li><strong>ShiftRows</strong>: shift rows by 0, 1, 2, 3 cells to the
left (wrapping)</li>
<li><strong>MixColumns</strong>: each column <span
class="math inline">c</span> we replace with <span
class="math inline">Mc</span> (<span class="math inline">M</span>
defined below)</li>
<li><strong>AddRoundKey</strong>: cell-wise XOR between round key</li>
</ul></li>
<li>last round skips <strong>MixColumns</strong></li>
</ul>
<p><span class="math display">
M = \begin{pmatrix}
    0x02 &amp; 0x03 &amp; 0x01 &amp; 0x01 \\
    0x01 &amp; 0x02 &amp; 0x03 &amp; 0x01 \\
    0x01 &amp; 0x01 &amp; 0x02 &amp; 0x03 \\
    0x03 &amp; 0x01 &amp; 0x01 &amp; 0x02 \\
\end{pmatrix}
</span></p>
<p>All operations are invertible. We however also need the inverse of
<span class="math inline">M</span>:</p>
<p><span class="math display">
M^{-1} = \begin{pmatrix}
    0x0e &amp; 0x0b &amp; 0x0d &amp; 0x09 \\
    0x09 &amp; 0x0e &amp; 0x0b &amp; 0x0d \\
    0x0d &amp; 0x09 &amp; 0x0e &amp; 0x0b \\
    0x0b &amp; 0x0d &amp; 0x09 &amp; 0x0e \\
\end{pmatrix}
</span></p>
<p>Arithmetics happens in <span class="math inline">GF(2^8)</span>. We
reduce everything modulo 2 and modulo <span class="math inline">x^8 +
x^4 + x^3 + x + 1</span>.</p>
<h4 data-number="1.2.2.1" id="ecb-mode"><span
class="header-section-number">1.2.2.1</span> ECB mode</h4>
<p>Encrypt each block of a larger plaintext independently with the same
key. Can leak information on repeating blocks.</p>
<h4 data-number="1.2.2.2" id="cbc-mode"><span
class="header-section-number">1.2.2.2</span> CBC mode</h4>
<p>Start with an initialization vector (IV). We XOR it with first block
and cipher it. Then, the result is XORed with the next block and then
encrypted, this continues. So instead of just encrypting the block, we
first mix the block with the cipher text from the previous block.</p>
<p>Three ways to handle IV:</p>
<ol type="1">
<li>use a non-secret constant IV (bad idea)</li>
<li>use secret IV which is part of the key (ok if not reused)</li>
<li>random IV that is sent in clear together with ciphertext</li>
</ol>
<p>If a block of ciphertext is corrupted only this and the next block of
plaintext is corrupted.</p>
<h4 data-number="1.2.2.3" id="ofb-mode"><span
class="header-section-number">1.2.2.3</span> OFB mode</h4>
<p>We encrypt IV and XOR with a block. The result of IV encryption is
passed to next encryption for the next block. We must have a new IV for
every plaintext. IV is a <strong>nonce</strong> (<strong>n</strong>umber
used <strong>once</strong>).</p>
<h4 data-number="1.2.2.4" id="ctr-mode"><span
class="header-section-number">1.2.2.4</span> CTR mode</h4>
<p>Have a counter <span class="math inline">t_i</span> and increment for
each block. We encrypt the counter and XOR with the block. <span
class="math inline">t_i</span> must be a nonce but also across every
block across every message. This means each block can be independently
computed.</p>
<h4 data-number="1.2.2.5" id="xts-mode"><span
class="header-section-number">1.2.2.5</span> XTS mode</h4>
<p>Used for hard disk encryption.</p>
<h5 data-number="1.2.2.5.1" id="ciphertext-stealing"><span
class="header-section-number">1.2.2.5.1</span> ciphertext stealing</h5>
<p>Method for encrypting messages that cannot be evenly divided into
blocks.</p>
<p>Let <span class="math inline">x</span> and <span
class="math inline">x&#39;</span> be the last two blocks where <span
class="math inline">x&#39;</span> is shorter than block length.</p>
<ol type="1">
<li>let <span class="math inline">Enc(x) = y&#39; || u</span> where
<span class="math inline">y&#39;</span> has same length as <span
class="math inline">x&#39;</span></li>
<li><span class="math inline">y = Enc&#39;(x&#39;||u)</span></li>
<li>return <span class="math inline">y</span> and <span
class="math inline">y&#39;</span></li>
</ol>
<h2 data-number="1.3" id="stream-ciphers"><span
class="header-section-number">1.3</span> stream ciphers</h2>
<p>Use a PRNG to generate a key stream. We seed the PRN with a fixed
secret key and a nonce. Optimized for hardware, efficient.</p>
<p>We can:</p>
<ol type="1">
<li>synchronize participants to a nonce (requires being stateful)</li>
<li>send the nonce in clear with ciphertext (requires nonce being
visible by an adversary)</li>
</ol>
<h3 data-number="1.3.1" id="rc4"><span
class="header-section-number">1.3.1</span> RC4</h3>
<p>Key length from 40 to 256 bits.</p>
<p>Weaknesses:</p>
<ul>
<li>there are some correlations between some output bytes and key bytes
when the nonce is known</li>
<li>output bytes are not uniformly distributed</li>
</ul>
<h2 data-number="1.4" id="bruteforce-inversion"><span
class="header-section-number">1.4</span> bruteforce inversion</h2>
<h3 data-number="1.4.1" id="opening-a-safe"><span
class="header-section-number">1.4.1</span> opening a safe</h3>
<p>Asking the safe if a key is correct. By bruteforce we can find the
correct key.</p>
<h4 data-number="1.4.1.1" id="uniform-distribution"><span
class="header-section-number">1.4.1.1</span> uniform distribution</h4>
<p>Exhaustive search for all keys. Expected value of iterations is <span
class="math inline">\frac{N + 1}{2}</span> for <span
class="math inline">N</span> keys.</p>
<h4 data-number="1.4.1.2" id="known-distribution"><span
class="header-section-number">1.4.1.2</span> known distribution</h4>
<p>Start search with the most probable keys (ordered by a permutation
<span class="math inline">\sigma</span>). Expected value of iterations
is <span class="math inline">\min_\sigma(\sum_{i=1}^N P[K =
k_{\sigma(i)}]i)</span> for a permutation (order of tested keys) <span
class="math inline">\sigma</span>. This expected value is called the
<strong>guesswork entropy</strong> of the distribution.</p>
<h4 data-number="1.4.1.3" id="unknown-distribution"><span
class="header-section-number">1.4.1.3</span> unknown distribution</h4>
<p>We choose a random permutation and start testing. Expected value of
iterations is <span class="math inline">\frac{N + 1}{2}</span> for <span
class="math inline">N</span> keys.</p>
<h4 data-number="1.4.1.4" id="key-recovery-game-online-attack"><span
class="header-section-number">1.4.1.4</span> key recovery game (online
attack)</h4>
<p>Online because we need to directly ask an oracle if a key is
correct.</p>
<p>Game:</p>
<ol type="1">
<li>pick <span class="math inline">K \in_D \mathcal K</span></li>
<li><span class="math inline">\mathcal A^{\mathcal O} \to k</span></li>
<li>return <span class="math inline">1_{K = k}</span></li>
</ol>
<h5 data-number="1.4.1.4.1" id="with-a-clue"><span
class="header-section-number">1.4.1.4.1</span> with a clue</h5>
<p>Game:</p>
<ol type="1">
<li>pick <span class="math inline">K \in_D \mathcal K</span></li>
<li><span class="math inline">W \leftarrow</span> clue about <span
class="math inline">K</span></li>
<li><span class="math inline">\mathcal A^{\mathcal O}(W) \to
k</span></li>
<li>return <span class="math inline">1_{K = k}</span></li>
</ol>
<h3 data-number="1.4.2" id="access-control"><span
class="header-section-number">1.4.2</span> access control</h3>
<ul>
<li>enrolment: enter user id and password. Register user id and a clue
about password.</li>
<li>access control: enter user id and password. Verify using the
clue.</li>
</ul>
<p>Example clue: the hash of a password.</p>
<h3 data-number="1.4.3" id="offline-attack"><span
class="header-section-number">1.4.3</span> offline attack</h3>
<p>We use a stop test function to test whether the key candidate is
consistent with the witness.</p>
<p>Offline key recovery:</p>
<ol type="1">
<li>pick <span class="math inline">K \in_D \mathcal K</span></li>
<li><span class="math inline">W \leftarrow F(K)</span></li>
<li><span class="math inline">\mathcal A(W) \to k</span></li>
<li>return <span class="math inline">1_{K = k}</span></li>
</ol>
<p>Inversion:</p>
<ol type="1">
<li>pick <span class="math inline">K \in_D \mathcal K</span></li>
<li><span class="math inline">W \leftarrow F(K)</span></li>
<li><span class="math inline">\mathcal A(W) \to k</span></li>
<li>return <span class="math inline">1_{F(k) = W}</span></li>
</ol>
<h4 data-number="1.4.3.1" id="inversion-by-exhaustive-search"><span
class="header-section-number">1.4.3.1</span> inversion by exhaustive
search</h4>
<p>For <span class="math inline">F : K \to Y</span> let <span
class="math inline">N = |K|</span> and <span class="math inline">M =
|Y|</span>. Finds the pre-image (key) of some clue <span
class="math inline">w \in_U Y</span>. Try keys until <span
class="math inline">F(k) = w</span>.</p>
<p><span class="math inline">E_F(P[\text{iterations} &gt; i]) = (1 -
\frac{1}{M})^i</span>. Expected number of iterations is <span
class="math inline">M(1 - e^{-\frac{N}{M}})</span> or just <span
class="math inline">M</span> when <span class="math inline">N \gg
M</span>.</p>
<h3 data-number="1.4.4" id="metrics-of-attacks"><span
class="header-section-number">1.4.4</span> metrics of attacks</h3>
<ul>
<li>pre-computation time</li>
<li>memory complexity</li>
<li>time complexity</li>
<li>number of online queries</li>
<li>probability of success</li>
</ul>
<h3 data-number="1.4.5" id="grovers-algorithm"><span
class="header-section-number">1.4.5</span> groverâ€™s algorithm</h3>
<p>Runs on a quantum computer and does bruteforce in <span
class="math inline">O(\sqrt N)</span>.</p>
<h2 data-number="1.5" id="double-encryption"><span
class="header-section-number">1.5</span> double encryption</h2>
<p>We run encryption twice with two different keys. This is not much
more secure. The security is only the sum of both encryptions rather
than their product.</p>
<h3 data-number="1.5.1" id="meet-in-the-middle-attack"><span
class="header-section-number">1.5.1</span> meet in the middle
attack</h3>
<p>Let <span class="math inline">y =
C&#39;&#39;_{k_2}(C&#39;_{k_1}(x))</span> be a double encryption of two
(possibly different) encryptions <span
class="math inline">C&#39;&#39;</span> and <span
class="math inline">C&#39;</span> with keys from their respective key
spaces <span class="math inline">\mathcal K&#39;&#39;, \mathcal
K&#39;</span>. We compute the encryption dictionary for <span
class="math inline">\mathcal K&#39;</span> for <span
class="math inline">x</span>. Then we look for the middle encryption by
checking keys from <span class="math inline">\mathcal K&#39;&#39;</span>
by doing decryption of the cipher text <span
class="math inline">y</span>.</p>
<h2 data-number="1.6" id="security"><span
class="header-section-number">1.6</span> security</h2>
<ul>
<li>CPA-breaking <span class="math inline">\implies</span>
CPCA-breaking</li>
<li>CPCA-secure <span class="math inline">\implies</span>
CPA-secure</li>
</ul>
<h3 data-number="1.6.1" id="key-recovery"><span
class="header-section-number">1.6.1</span> key recovery</h3>
<h4 data-number="1.6.1.1" id="cpa-chosen-plaintext-attacks"><span
class="header-section-number">1.6.1.1</span> CPA (chosen plaintext
attacks)</h4>
<p>Game:</p>
<ol type="1">
<li><span class="math inline">K \stackrel{\$}{\leftarrow} \{0,
1\}^k</span></li>
<li>Used <span class="math inline">\leftarrow \emptyset</span></li>
<li><span class="math inline">W \leftarrow F(K)</span></li>
<li><span class="math inline">\mathcal A^{OEnc} \to K&#39;</span></li>
<li>return <span class="math inline">1_{K = K&#39;}</span></li>
</ol>
<p>OEnc(N, X):</p>
<ol type="1">
<li>if <span class="math inline">N \in</span> Used then return <span
class="math inline">\bot</span></li>
<li>Used <span class="math inline">\leftarrow</span> Used <span
class="math inline">\cup</span> {N}</li>
<li>return Enc(K, N, X)</li>
</ol>
<h4 data-number="1.6.1.2"
id="cpca-chosen-plaintextciphertext-attacks"><span
class="header-section-number">1.6.1.2</span> CPCA (chosen
plaintext/ciphertext attacks)</h4>
<p>Game:</p>
<ol type="1">
<li><span class="math inline">K \stackrel{\$}{\leftarrow} \{0,
1\}^k</span></li>
<li>Used <span class="math inline">\leftarrow \emptyset</span></li>
<li><span class="math inline">W \leftarrow F(K)</span></li>
<li><span class="math inline">\mathcal A^{OEnc, ODec} \to
K&#39;</span></li>
<li>return <span class="math inline">1_{K = K&#39;}</span></li>
</ol>
<p>OEnc(N, X):</p>
<ol type="1">
<li>if <span class="math inline">N \in</span> Used then return <span
class="math inline">\bot</span></li>
<li>Used <span class="math inline">\leftarrow</span> Used <span
class="math inline">\cup</span> {N}</li>
<li>return Enc(K, N, X)</li>
</ol>
<p>ODec(N, Y):</p>
<ol start="3" type="1">
<li>return Dec(K, N, Y)</li>
</ol>
<h3 data-number="1.6.2" id="decryption"><span
class="header-section-number">1.6.2</span> decryption</h3>
<h4 data-number="1.6.2.1" id="cpa-chosen-plaintext-attacks-1"><span
class="header-section-number">1.6.2.1</span> CPA (chosen plaintext
attacks)</h4>
<p>Game:</p>
<ol type="1">
<li><span class="math inline">K \stackrel{\$}{\leftarrow} \{0,
1\}^k</span></li>
<li><span class="math inline">X_0 \stackrel{\$}{\leftarrow} \mathcal
D</span>, <span class="math inline">N_0 \stackrel{\$}{\leftarrow}
\mathcal N</span></li>
<li>Used <span class="math inline">\leftarrow \{N_0\}</span></li>
<li><span class="math inline">Y_0 \leftarrow</span> Enc(<span
class="math inline">K, N_0, X_0</span>)</li>
<li><span class="math inline">W \leftarrow F(K)</span></li>
<li><span class="math inline">\mathcal A^{OEnc}(N_0, Y_0) \to
X</span></li>
<li>return <span class="math inline">1_{X_0 = X}</span></li>
</ol>
<p>OEnc(N, X):</p>
<ol type="1">
<li>if <span class="math inline">N \in</span> Used then return <span
class="math inline">\bot</span></li>
<li>Used <span class="math inline">\leftarrow</span> Used <span
class="math inline">\cup</span> {N}</li>
<li>return Enc(K, N, X)</li>
</ol>
<h4 data-number="1.6.2.2"
id="cpca-chosen-plaintextciphertext-attacks-1"><span
class="header-section-number">1.6.2.2</span> CPCA (chosen
plaintext/ciphertext attacks)</h4>
<p>Game:</p>
<ol type="1">
<li><span class="math inline">K \stackrel{\$}{\leftarrow} \{0,
1\}^k</span></li>
<li><span class="math inline">X_0 \stackrel{\$}{\leftarrow} \mathcal
D</span>, <span class="math inline">N_0 \stackrel{\$}{\leftarrow}
\mathcal N</span></li>
<li>Used <span class="math inline">\leftarrow \{N_0\}</span></li>
<li><span class="math inline">Y_0 \leftarrow</span> Enc(<span
class="math inline">K, N_0, X_0</span>)</li>
<li><span class="math inline">W \leftarrow F(K)</span></li>
<li><span class="math inline">\mathcal A^{OEnc, ODec}(N_0, Y_0) \to
X</span></li>
<li>return <span class="math inline">1_{X_0 = X}</span></li>
</ol>
<p>OEnc(N, X):</p>
<ol type="1">
<li>if <span class="math inline">N \in</span> Used then return <span
class="math inline">\bot</span></li>
<li>Used <span class="math inline">\leftarrow</span> Used <span
class="math inline">\cup</span> {N}</li>
<li>return Enc(K, N, X)</li>
</ol>
<p>ODec(N, Y):</p>
<ol type="1">
<li>if <span class="math inline">(N, Y) = (N_0, Y_0)</span> then return
<span class="math inline">\bot</span></li>
<li>return Dec(K, N, Y)</li>
</ol>
<h3 data-number="1.6.3" id="distinguisher"><span
class="header-section-number">1.6.3</span> distinguisher</h3>
<h4 data-number="1.6.3.1" id="ideal-cipher"><span
class="header-section-number">1.6.3.1</span> ideal cipher</h4>
<p>An ideal cipher is a cipher taking a random key K and returning a
permutation over the domain.</p>
<h4 data-number="1.6.3.2" id="cpa-against-distinguisher"><span
class="header-section-number">1.6.3.2</span> CPA (against
distinguisher)</h4>
<p><span class="math display">
Adv = Pr[\Gamma_1 \text{ returns } 1] - Pr[\Gamma_0 \text{ returns } 1]
</span></p>
<p>Game <span class="math inline">\Gamma_b</span>:</p>
<ol type="1">
<li><span class="math inline">K \stackrel{\$}{\leftarrow} \{0,
1\}^k</span></li>
<li>for every N, pick a length-preserving permutation <span
class="math inline">\Pi_N</span> over D</li>
<li>Used <span class="math inline">\leftarrow \{\}</span></li>
<li><span class="math inline">\mathcal A^{OEnc} \to z</span></li>
<li>return <span class="math inline">z</span></li>
</ol>
<p>OEnc(N, X):</p>
<ol type="1">
<li>if <span class="math inline">N \in</span> Used then return <span
class="math inline">\bot</span></li>
<li>Used <span class="math inline">\leftarrow</span> Used <span
class="math inline">\cup</span> {N}</li>
<li>if b = 0 then return <span class="math inline">\Pi_N(X)</span></li>
<li>return Enc(K, N, X)</li>
</ol>
<h4 data-number="1.6.3.3" id="cpca-against-distinguisher"><span
class="header-section-number">1.6.3.3</span> CPCA (against
distinguisher)</h4>
<p>Game <span class="math inline">\Gamma_b</span>:</p>
<ol type="1">
<li><span class="math inline">K \stackrel{\$}{\leftarrow} \{0,
1\}^k</span></li>
<li>for every N, pick a length-preserving permutation <span
class="math inline">\Pi_N</span> over D</li>
<li>Used <span class="math inline">\leftarrow \{\}</span></li>
<li><span class="math inline">\mathcal A^{OEnc, ODec} \to z</span></li>
<li>return <span class="math inline">z</span></li>
</ol>
<p>OEnc(N, X):</p>
<ol type="1">
<li>if <span class="math inline">N \in</span> Used then return <span
class="math inline">\bot</span></li>
<li>Used <span class="math inline">\leftarrow</span> Used <span
class="math inline">\cup</span> {N}</li>
<li>if b = 0 then return <span class="math inline">\Pi_N(X)</span></li>
<li>return Enc(K, N, X)</li>
</ol>
<p>ODec(N, Y):</p>
<ol type="1">
<li>if b = 0 then return <span
class="math inline">\Pi_N^{-1}(Y)</span></li>
<li>return Dec(K, N, Y)</li>
</ol>
<h3 data-number="1.6.4" id="notions"><span
class="header-section-number">1.6.4</span> notions</h3>
<table>
<thead>
<tr class="header">
<th></th>
<th>key recovery</th>
<th>decryption</th>
<th>distinguisher</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CPA</td>
<td>weakest security</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>CPCA</td>
<td></td>
<td></td>
<td>strongest security</td>
</tr>
</tbody>
</table>
<ul>
<li>if we can recover the key, we can decrypt</li>
<li>if we can decrypt we can recognize from the ideal cipher</li>
<li>if we can break without chosen ciphertext, then we can also beak
with</li>
</ul>
</body>
</html>
